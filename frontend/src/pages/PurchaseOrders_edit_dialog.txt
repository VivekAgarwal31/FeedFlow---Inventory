            </Dialog>

            {/* Edit Purchase Order Dialog */}
            <Dialog open={editDialogOpen} onOpenChange={setEditDialogOpen}>
                <DialogContent className="max-w-4xl max-h-[90vh] overflow-y-auto">
                    <DialogHeader>
                        <DialogTitle>Edit Purchase Order - #{editingOrder?.orderNumber}</DialogTitle>
                        <DialogDescription>Update order quantities and prices (preserves receipt progress)</DialogDescription>
                    </DialogHeader>
                    {editingOrder && (
                        <div className="space-y-6">
                            <div className="grid grid-cols-2 md:grid-cols-3 gap-4 p-4 bg-muted/50 rounded-lg">
                                <div><Label className="text-muted-foreground">Order Number</Label><p className="font-mono font-medium">#{editingOrder.orderNumber}</p></div>
                                <div><Label className="text-muted-foreground">Supplier</Label><p className="font-medium">{editingOrder.supplierName}</p></div>
                                <div><Label className="text-muted-foreground">Order Date</Label><p className="font-medium">{formatDate(editingOrder.orderDate)}</p></div>
                            </div>
                            <div>
                                <h3 className="font-semibold mb-3">Items</h3>
                                <Table>
                                    <TableHeader><TableRow><TableHead>Item</TableHead><TableHead>Quantity</TableHead><TableHead>Cost Price</TableHead><TableHead>Total</TableHead></TableRow></TableHeader>
                                    <TableBody>
                                        {editForm.items.map((item, index) => (
                                            <TableRow key={index}>
                                                <TableCell className="font-medium">{item.itemName}</TableCell>
                                                <TableCell><Input type="number" min="0" step="1" value={item.quantity} onChange={(e) => handleEditItemChange(index, 'quantity', e.target.value)} className="w-24" /></TableCell>
                                                <TableCell><Input type="number" min="0" step="0.01" value={item.costPrice} onChange={(e) => handleEditItemChange(index, 'costPrice', e.target.value)} className="w-28" /></TableCell>
                                                <TableCell className="font-mono font-medium">{formatCurrency(item.total)}</TableCell>
                                            </TableRow>
                                        ))}
                                        <TableRow>
                                            <TableCell colSpan={2} className="font-semibold">Total Amount</TableCell>
                                            <TableCell className="font-mono font-bold text-lg" colSpan={2}>{formatCurrency(calculateEditTotal())}</TableCell>
                                        </TableRow>
                                    </TableBody>
                                </Table>
                            </div>
                            <div className="space-y-2">
                                <Label htmlFor="edit-notes">Notes</Label>
                                <Input id="edit-notes" placeholder="Additional notes..." value={editForm.notes} onChange={(e) => setEditForm({ ...editForm, notes: e.target.value })} />
                            </div>
                            <div className="flex gap-3 pt-4">
                                <Button onClick={handleEditSubmit} disabled={submitting} className="flex-1">{submitting ? <><Loader2 className="mr-2 h-4 w-4 animate-spin" />Updating...</> : `Update Order - ${formatCurrency(calculateEditTotal())}`}</Button>
                                <Button type="button" variant="outline" onClick={() => setEditDialogOpen(false)} disabled={submitting}>Cancel</Button>
                            </div>
                        </div>
                    )}
                </DialogContent>
            </Dialog>
        </div>
    )
}

export default PurchaseOrders
